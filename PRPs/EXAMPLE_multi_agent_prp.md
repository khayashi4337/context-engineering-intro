name: "ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ï¼šãƒªã‚µãƒ¼ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼‹ãƒ¡ãƒ¼ãƒ«ä¸‹ä½ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ"
description: |

## ç›®çš„ï¼ˆPurposeï¼‰
Brave Search APIã‚’åˆ©ç”¨ã™ã‚‹ä¸»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼ˆResearch Agentï¼‰ãŒã€Gmail APIã‚’ä½¿ã†ãƒ¡ãƒ¼ãƒ«ä¸‹ä½ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼ˆEmail Draft Agentï¼‰ã‚’ãƒ„ãƒ¼ãƒ«ã¨ã—ã¦å‘¼ã³å‡ºã™ã€Pydantic AIã®ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚å¤–éƒ¨APIé€£æºã‚’å«ã‚€ã€Œã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ãƒ„ãƒ¼ãƒ«åŒ–ã™ã‚‹ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å®Ÿä¾‹ã§ã™ã€‚

## åŸºæœ¬åŸå‰‡ï¼ˆCore Principlesï¼‰
1. **ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæœ€å„ªå…ˆ**ï¼šå¿…è¦ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ»ä¾‹ãƒ»æ³¨æ„ç‚¹ã‚’ã™ã¹ã¦å«ã‚ã‚‹
2. **ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ—**ï¼šAIãŒå®Ÿè¡Œãƒ»ä¿®æ­£ã§ãã‚‹ãƒ†ã‚¹ãƒˆã‚„ãƒªãƒ³ãƒˆã‚’å¿…ãšç”¨æ„
3. **æƒ…å ±å¯†åº¦é‡è¦–**ï¼šã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚„ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ´»ç”¨
4. **æ®µéšçš„ãªæˆåŠŸ**ï¼šã¾ãšã‚·ãƒ³ãƒ—ãƒ«ã«ä½œã‚Šã€æ¤œè¨¼ã—ã€å¾ã€…ã«å¼·åŒ–

---

## ã‚´ãƒ¼ãƒ«ï¼ˆGoalï¼‰
CLIçµŒç”±ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒªã‚µãƒ¼ãƒä¾é ¼ã‚’å‡ºã—ã€Research AgentãŒãƒ¡ãƒ¼ãƒ«ä½œæˆã‚¿ã‚¹ã‚¯ã‚’Email Draft Agentã«å§”è­²ã§ãã‚‹ã€å®Ÿé‹ç”¨ãƒ¬ãƒ™ãƒ«ã®ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ã‚’ä½œæˆã—ã¾ã™ã€‚è¤‡æ•°LLMãƒ—ãƒ­ãƒã‚¤ãƒ€å¯¾å¿œãƒ»APIèªè¨¼ã®å®‰å…¨ç®¡ç†ã‚‚å¿…é ˆã§ã™ã€‚

## ãªãœï¼ˆWhyï¼‰
- **ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤**ï¼šãƒªã‚µãƒ¼ãƒã¨ãƒ¡ãƒ¼ãƒ«ä¸‹æ›¸ãæ¥­å‹™ã‚’è‡ªå‹•åŒ–
- **çµ±åˆæ€§**ï¼šé«˜åº¦ãªPydantic AIãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å®Ÿè¨¼
- **è§£æ±ºã™ã‚‹èª²é¡Œ**ï¼šãƒªã‚µãƒ¼ãƒãƒ™ãƒ¼ã‚¹ã®ãƒ¡ãƒ¼ãƒ«ä½œæˆæ¥­å‹™ã®æ‰‹é–“å‰Šæ¸›

## ä½•ã‚’ï¼ˆWhatï¼‰
CLIãƒ™ãƒ¼ã‚¹ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼š
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒªã‚µãƒ¼ãƒã‚¯ã‚¨ãƒªã‚’å…¥åŠ›
- Research AgentãŒBrave APIã§æ¤œç´¢
- Research AgentãŒEmail Draft Agentã‚’å‘¼ã³å‡ºã—Gmailä¸‹æ›¸ãã‚’ä½œæˆ
- çµæœãŒãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°è¿”å´

### æˆåŠŸåŸºæº–ï¼ˆSuccess Criteriaï¼‰
- [ ] Research AgentãŒBrave APIã§æ­£å¸¸ã«æ¤œç´¢ã§ãã‚‹
- [ ] Email AgentãŒèªè¨¼ä»˜ãã§Gmailä¸‹æ›¸ãã‚’ä½œæˆã§ãã‚‹
- [ ] Research AgentãŒEmail Agentã‚’ãƒ„ãƒ¼ãƒ«ã¨ã—ã¦å‘¼ã³å‡ºã›ã‚‹
- [ ] CLIãŒãƒ„ãƒ¼ãƒ«åˆ©ç”¨çŠ¶æ³ã‚’å«ã‚ã¦ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å¿œç­”ã§ãã‚‹
- [ ] ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒé€šã‚Šã€ã‚³ãƒ¼ãƒ‰å“è³ªåŸºæº–ã‚’æº€ãŸã™

## å¿…è¦ãªã™ã¹ã¦ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ»å‚è€ƒè³‡æ–™ï¼ˆDocumentation & Referencesï¼‰
```yaml
# å¿…èª­ - å®Ÿè£…ã«å¿…è¦ãªæ–‡è„ˆã‚’ã™ã¹ã¦ã“ã“ã«ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—
- url: https://ai.pydantic.dev/agents/
  why: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆä½œæˆãƒ‘ã‚¿ãƒ¼ãƒ³
  
- url: https://ai.pydantic.dev/multi-agent-applications/
  why: ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆagent-as-toolå«ã‚€ï¼‰
  
- url: https://developers.google.com/gmail/api/guides/sending
  why: Gmail APIèªè¨¼ã¨ä¸‹æ›¸ãä½œæˆ
  
- url: https://api-dashboard.search.brave.com/app/documentation
  why: Brave Search APIã®RESTã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
  
- file: examples/agent/agent.py
  why: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆä½œæˆãƒ»ãƒ„ãƒ¼ãƒ«ç™»éŒ²ãƒ»ä¾å­˜æ€§æ³¨å…¥ã®ãƒ‘ã‚¿ãƒ¼ãƒ³
  
- file: examples/agent/providers.py
  why: è¤‡æ•°ãƒ—ãƒ­ãƒã‚¤ãƒ€LLMè¨­å®šãƒ‘ã‚¿ãƒ¼ãƒ³
  
- file: examples/cli.py
  why: ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å¿œç­”ãƒ»ãƒ„ãƒ¼ãƒ«å¯è¦–åŒ–ã¤ãCLIæ§‹é€ 

- url: https://github.com/googleworkspace/python-samples/blob/main/gmail/snippet/send%20mail/create_draft.py
  why: Gmailä¸‹æ›¸ãä½œæˆã®å…¬å¼ä¾‹
```

### ç¾åœ¨ã®ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹æ§‹æˆ
```bash
.
â”œâ”€â”€ examples/
â”‚   â”œâ”€â”€ agent/
â”‚   â”‚   â”œâ”€â”€ agent.py
â”‚   â”‚   â”œâ”€â”€ providers.py
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ cli.py
â”œâ”€â”€ PRPs/
â”‚   â””â”€â”€ templates/
â”‚       â””â”€â”€ prp_base.md
â”œâ”€â”€ INITIAL.md
â”œâ”€â”€ CLAUDE.md
â””â”€â”€ requirements.txt
```

### è¿½åŠ å¾Œã®ç†æƒ³çš„ãªã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹æ§‹æˆ
```bash
.
â”œâ”€â”€ agents/
â”‚   â”œâ”€â”€ __init__.py               # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åˆæœŸåŒ–
â”‚   â”œâ”€â”€ research_agent.py         # Brave Searchå¯¾å¿œä¸»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ email_agent.py           # Gmailå¯¾å¿œä¸‹ä½ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ providers.py             # LLMãƒ—ãƒ­ãƒã‚¤ãƒ€è¨­å®š
â”‚   â””â”€â”€ models.py                # Pydanticãƒ‡ãƒ¼ã‚¿ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¢ãƒ‡ãƒ«
â”œâ”€â”€ tools/
â”‚   â”œâ”€â”€ __init__.py              # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åˆæœŸåŒ–
â”‚   â”œâ”€â”€ brave_search.py          # Brave Search APIé€£æº
â”‚   â””â”€â”€ gmail_tool.py            # Gmail APIé€£æº
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ __init__.py              # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åˆæœŸåŒ–
â”‚   â””â”€â”€ settings.py              # ç’°å¢ƒãƒ»è¨­å®šç®¡ç†
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ __init__.py              # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åˆæœŸåŒ–
â”‚   â”œâ”€â”€ test_research_agent.py   # Research agentãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ test_email_agent.py      # Email agentãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ test_brave_search.py     # Brave searchãƒ„ãƒ¼ãƒ«ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ test_gmail_tool.py       # Gmailãƒ„ãƒ¼ãƒ«ãƒ†ã‚¹ãƒˆ
â”‚   â””â”€â”€ test_cli.py              # CLIãƒ†ã‚¹ãƒˆ
â”œâ”€â”€ cli.py                       # CLIã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”œâ”€â”€ .env.example                 # ç’°å¢ƒå¤‰æ•°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â”œâ”€â”€ requirements.txt             # ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
â”œâ”€â”€ README.md                    # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â””â”€â”€ credentials/.gitkeep         # Gmailèªè¨¼æƒ…å ±ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
```

### æ—¢çŸ¥ã®æ³¨æ„ç‚¹ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ç™–
```python
# é‡è¦: Pydantic AIã¯å…¨ã¦asyncå¿…é ˆï¼ˆåŒæœŸé–¢æ•°NGï¼‰
# é‡è¦: Gmail APIã¯åˆå›OAuth2èªè¨¼ãŒå¿…è¦ï¼ˆcredentials.jsonå¿…é ˆï¼‰
# é‡è¦: Brave APIã¯ç„¡æ–™æ ã§æœˆ2000ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¾ã§
# é‡è¦: agent-as-toolãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ctx.usageã§ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†å¿…é ˆ
# é‡è¦: Gmailä¸‹æ›¸ãã¯base64ï¼‹æ­£ã—ã„MIMEå½¢å¼ã§ä½œæˆ
# é‡è¦: çµ¶å¯¾ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ¨å¥¨
# é‡è¦: æ©Ÿå¯†æƒ…å ±ã¯.envç®¡ç†ã€ã‚³ãƒŸãƒƒãƒˆç¦æ­¢
```

## å®Ÿè£…è¨­è¨ˆï¼ˆImplementation Blueprintï¼‰

### ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ãƒ»æ§‹é€ 

```python
# models.py - ã‚³ã‚¢ãƒ‡ãƒ¼ã‚¿æ§‹é€ 
from pydantic import BaseModel, Field
from typing import List, Optional
from datetime import datetime

class ResearchQuery(BaseModel):
    query: str = Field(..., description="èª¿æŸ»ãƒˆãƒ”ãƒƒã‚¯")
    max_results: int = Field(10, ge=1, le=50)
    include_summary: bool = Field(True)

class BraveSearchResult(BaseModel):
    title: str
    url: str
    description: str
    score: float = Field(0.0, ge=0.0, le=1.0)

class EmailDraft(BaseModel):
    to: List[str] = Field(..., min_items=1)
    subject: str = Field(..., min_length=1)
    body: str = Field(..., min_length=1)
    cc: Optional[List[str]] = None
    bcc: Optional[List[str]] = None

class ResearchEmailRequest(BaseModel):
    research_query: str
    email_context: str = Field(..., description="ãƒ¡ãƒ¼ãƒ«ç”Ÿæˆã®ãŸã‚ã®æ–‡è„ˆ")
    recipient_email: str
```

### ã‚¿ã‚¹ã‚¯ä¸€è¦§

```yaml
Task 1: è¨­å®šãƒ»ç’°å¢ƒæº–å‚™
CREATE config/settings.py:
  - PATTERN: pydantic-settingsã‚„os.getenvåˆ©ç”¨ä¾‹ã‚’è¸è¥²
  - ç’°å¢ƒå¤‰æ•°ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆä»˜ãã§ãƒ­ãƒ¼ãƒ‰
  - å¿…é ˆAPIã‚­ãƒ¼ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

CREATE .env.example:
  - å¿…è¦ãªç’°å¢ƒå¤‰æ•°ã‚’ã™ã¹ã¦èª¬æ˜ä»˜ãã§è¨˜è¼‰
  - examples/README.mdã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è¸è¥²

Task 2: Brave Searchãƒ„ãƒ¼ãƒ«å®Ÿè£…
CREATE tools/brave_search.py:
  - PATTERN: examples/agent/tools.pyã®asyncé–¢æ•°ãƒ‘ã‚¿ãƒ¼ãƒ³
  - httpxåˆ©ç”¨ã®ã‚·ãƒ³ãƒ—ãƒ«ãªRESTã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
  - ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãƒ»ã‚¨ãƒ©ãƒ¼ã‚’é©åˆ‡ã«å‡¦ç†
  - BraveSearchResultãƒ¢ãƒ‡ãƒ«ã§è¿”å´

Task 3: Gmailãƒ„ãƒ¼ãƒ«å®Ÿè£…
CREATE tools/gmail_tool.py:
  - PATTERN: Gmailã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆã®OAuth2ãƒ•ãƒ­ãƒ¼ã‚’è¸è¥²
  - credentials/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«token.jsonä¿å­˜
  - æ­£ã—ã„MIMEã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã§ä¸‹æ›¸ãä½œæˆ
  - èªè¨¼ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ã‚‚è‡ªå‹•å¯¾å¿œ

Task 4: Email Draft Agentä½œæˆ
CREATE agents/email_agent.py:
  - PATTERN: examples/agent/agent.pyæ§‹é€ ã‚’è¸è¥²
  - deps_typeãƒ‘ã‚¿ãƒ¼ãƒ³ã§Agentä½œæˆ
  - gmail_toolã‚’@agent.toolã§ç™»éŒ²
  - EmailDraftãƒ¢ãƒ‡ãƒ«ã§è¿”å´

Task 5: Research Agentä½œæˆ
CREATE agents/research_agent.py:
  - PATTERN: Pydantic AI docsã®ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³
  - brave_searchã‚’ãƒ„ãƒ¼ãƒ«ã¨ã—ã¦ç™»éŒ²
  - email_agent.run()ã‚‚ãƒ„ãƒ¼ãƒ«ç™»éŒ²
  - ä¾å­˜æ€§æ³¨å…¥ã«RunContextåˆ©ç”¨

Task 6: CLIã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®Ÿè£…
CREATE cli.py:
  - PATTERN: examples/cli.pyã®ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å‡ºåŠ›ãƒ‘ã‚¿ãƒ¼ãƒ³
  - ãƒ„ãƒ¼ãƒ«å¯è¦–åŒ–ãƒ»ã‚«ãƒ©ãƒ¼å‡ºåŠ›
  - asyncio.run()ã§asyncå¯¾å¿œ
  - ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã§ä¼šè©±æ–‡è„ˆä¿æŒ

Task 7: ãƒ†ã‚¹ãƒˆè¿½åŠ 
CREATE tests/:
  - PATTERN: examplesé…ä¸‹ã®ãƒ†ã‚¹ãƒˆæ§‹é€ ã‚’è¸è¥²
  - å¤–éƒ¨APIã¯ãƒ¢ãƒƒã‚¯åŒ–
  - ãƒãƒƒãƒ”ãƒ¼ãƒ‘ã‚¹ãƒ»ã‚¨ãƒƒã‚¸ãƒ»ã‚¨ãƒ©ãƒ¼å…¨ç¶²ç¾…
  - ã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Š

Task 8: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ
CREATE README.md:
  - PATTERN: examples/README.mdæ§‹é€ ã‚’è¸è¥²
  - ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ»ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ»ä½¿ã„æ–¹
  - APIã‚­ãƒ¼è¨­å®šæ‰‹é †
  - ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³
```

### å„ã‚¿ã‚¹ã‚¯ã”ã¨ã®æ“¬ä¼¼ã‚³ãƒ¼ãƒ‰

```python
# Task 2: Brave Searchãƒ„ãƒ¼ãƒ«
async def search_brave(query: str, api_key: str, count: int = 10) -> List[BraveSearchResult]:
    # PATTERN: httpxåˆ©ç”¨ï¼ˆexamplesã¯aiohttpï¼‰
    async with httpx.AsyncClient() as client:
        headers = {"X-Subscription-Token": api_key}
        params = {"q": query, "count": count}
        
        # æ³¨æ„: APIã‚­ãƒ¼ç„¡åŠ¹æ™‚ã¯401
        response = await client.get(
            "https://api.search.brave.com/res/v1/web/search",
            headers=headers,
            params=params,
            timeout=30.0  # é‡è¦: ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå¿…é ˆ
        )
        
        # ã‚¨ãƒ©ãƒ¼å‡¦ç†ãƒ‘ã‚¿ãƒ¼ãƒ³
        if response.status_code != 200:
            raise BraveAPIError(f"API returned {response.status_code}")
        
        # Pydanticã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
        data = response.json()
        return [BraveSearchResult(**result) for result in data.get("web", {}).get("results", [])]

# Task 5: Research Agentã‹ã‚‰Email Agentãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—
@research_agent.tool
async def create_email_draft(
    ctx: RunContext[AgentDependencies],
    recipient: str,
    subject: str,
    context: str
) -> str:
    """ãƒªã‚µãƒ¼ãƒæ–‡è„ˆã‹ã‚‰ãƒ¡ãƒ¼ãƒ«ä¸‹æ›¸ãã‚’ä½œæˆ"""
    # é‡è¦: ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†ã®ãŸã‚usageã‚’æ¸¡ã™
    result = await email_agent.run(
        f"Create an email to {recipient} about: {context}",
        deps=EmailAgentDeps(subject=subject),
        usage=ctx.usage  # multi-agent docsã®ãƒ‘ã‚¿ãƒ¼ãƒ³
    )
    
    return f"Draft created with ID: {result.data}"
```

### çµ±åˆãƒã‚¤ãƒ³ãƒˆ
```yaml
ENVIRONMENT:
  - .envã«è¿½åŠ 
  - å¤‰æ•°ä¾‹:
      # LLMè¨­å®š
      LLM_PROVIDER=openai
      LLM_API_KEY=sk-...
      LLM_MODEL=gpt-4
      
      # Brave Search
      BRAVE_API_KEY=BSA...
      
      # Gmailï¼ˆcredentials.jsonã®ãƒ‘ã‚¹ï¼‰
      GMAIL_CREDENTIALS_PATH=./credentials/credentials.json
      
CONFIG:
  - Gmail OAuth: åˆå›ã¯ãƒ–ãƒ©ã‚¦ã‚¶ã§èªè¨¼
  - ãƒˆãƒ¼ã‚¯ãƒ³ä¿å­˜: ./credentials/token.jsonï¼ˆè‡ªå‹•ç”Ÿæˆï¼‰
  
DEPENDENCIES:
  - requirements.txtã«ä»¥ä¸‹ã‚’è¿½åŠ :
    - google-api-python-client
    - google-auth-httplib2
    - google-auth-oauthlib
```

## ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ—ï¼ˆValidation Loopï¼‰

### ãƒ¬ãƒ™ãƒ«1ï¼šæ§‹æ–‡ãƒ»ã‚¹ã‚¿ã‚¤ãƒ«
```bash
# ã¾ãšã“ã‚Œã‚‰ã‚’å®Ÿè¡Œã—ã€ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Œã°ä¿®æ­£ã—ã¦ã‹ã‚‰é€²ã‚ã‚‹
ruff check . --fix              # ã‚¹ã‚¿ã‚¤ãƒ«è‡ªå‹•ä¿®æ­£
mypy .                          # å‹ãƒã‚§ãƒƒã‚¯

# æœŸå¾…å€¤: ã‚¨ãƒ©ãƒ¼ãªã—ã€‚ã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸã‚‰å¿…ãšä¿®æ­£ã€‚
```

### ãƒ¬ãƒ™ãƒ«2ï¼šãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
```python
# test_research_agent.py
async def test_research_with_brave():
    """Research AgentãŒæ­£ã—ãæ¤œç´¢ã§ãã‚‹ã‹"""
    agent = create_research_agent()
    result = await agent.run("AI safety research")
    assert result.data
    assert len(result.data) > 0

async def test_research_creates_email():
    """Research AgentãŒEmail Agentã‚’å‘¼ã¹ã‚‹ã‹"""
    agent = create_research_agent()
    result = await agent.run(
        "Research AI safety and draft email to john@example.com"
    )
    assert "draft_id" in result.data

# test_email_agent.py  
def test_gmail_authentication(monkeypatch):
    """Gmail OAuthãƒ•ãƒ­ãƒ¼ã®ãƒ†ã‚¹ãƒˆ"""
    monkeypatch.setenv("GMAIL_CREDENTIALS_PATH", "test_creds.json")
    tool = GmailTool()
    assert tool.service is not None

async def test_create_draft():
    """æ­£ã—ã„ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã§ä¸‹æ›¸ãä½œæˆã§ãã‚‹ã‹"""
    agent = create_email_agent()
    result = await agent.run(
        "Create email to test@example.com about AI research"
    )
    assert result.data.get("draft_id")
```

```bash
# ãƒ†ã‚¹ãƒˆãŒé€šã‚‹ã¾ã§ç¹°ã‚Šè¿”ã—å®Ÿè¡Œï¼š
pytest tests/ -v --cov=agents --cov=tools --cov-report=term-missing

# å¤±æ•—æ™‚: å€‹åˆ¥ãƒ†ã‚¹ãƒˆã‚’ãƒ‡ãƒãƒƒã‚°ãƒ»ä¿®æ­£â†’å†å®Ÿè¡Œ
```

### ãƒ¬ãƒ™ãƒ«3ï¼šçµ±åˆãƒ†ã‚¹ãƒˆ
```bash
# CLIå¯¾è©±ãƒ†ã‚¹ãƒˆ
python cli.py

# æœŸå¾…ã•ã‚Œã‚‹å¯¾è©±ä¾‹ï¼š
# You: Research latest AI safety developments
# ğŸ¤– Assistant: [ãƒªã‚µãƒ¼ãƒçµæœã‚’ã‚¹ãƒˆãƒªãƒ¼ãƒ ]
# ğŸ›  ä½¿ç”¨ãƒ„ãƒ¼ãƒ«:
#   1. brave_search (query='AI safety developments', limit=10)
#
# You: Create an email draft about this to john@example.com  
# ğŸ¤– Assistant: [ä¸‹æ›¸ãä½œæˆ]
# ğŸ›  ä½¿ç”¨ãƒ„ãƒ¼ãƒ«:
#   1. create_email_draft (recipient='john@example.com', ...)

# Gmailã®ä¸‹æ›¸ããƒ•ã‚©ãƒ«ãƒ€ã‚’ç¢ºèª
```

## æœ€çµ‚ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
- [ ] ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒé€šã‚‹: `pytest tests/ -v`
- [ ] ãƒªãƒ³ãƒˆã‚¨ãƒ©ãƒ¼ãªã—: `ruff check .`
- [ ] å‹ã‚¨ãƒ©ãƒ¼ãªã—: `mypy .`
- [ ] Gmail OAuthãƒ•ãƒ­ãƒ¼ãŒå‹•ä½œï¼ˆãƒ–ãƒ©ã‚¦ã‚¶èªè¨¼ãƒ»ãƒˆãƒ¼ã‚¯ãƒ³ä¿å­˜ï¼‰
- [ ] Brave Searchã§æ¤œç´¢ã§ãã‚‹
- [ ] Research AgentãŒEmail Agentã‚’å‘¼ã³å‡ºã›ã‚‹
- [ ] CLIãŒãƒ„ãƒ¼ãƒ«å¯è¦–åŒ–ã¤ãã§ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å¿œç­”
- [ ] ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã‚‚é©åˆ‡ã«å‡¦ç†
- [ ] READMEã«ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †ãŒæ˜è¨˜
- [ ] .env.exampleã«å…¨å¿…è¦å¤‰æ•°ã‚ã‚Š

---

## NGãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ»ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³
- âŒ APIã‚­ãƒ¼ã®ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç¦æ­¢ï¼ˆå¿…ãšç’°å¢ƒå¤‰æ•°ï¼‰
- âŒ asyncã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæ–‡è„ˆã§åŒæœŸé–¢æ•°ç¦æ­¢
- âŒ Gmail OAuthãƒ•ãƒ­ãƒ¼ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—çœç•¥ç¦æ­¢
- âŒ APIãƒ¬ãƒ¼ãƒˆåˆ¶é™ç„¡è¦–ç¦æ­¢
- âŒ multi-agentå‘¼ã³å‡ºã—ã§ctx.usageæ¸¡ã—å¿˜ã‚Œç¦æ­¢
- âŒ credentials.jsonã‚„token.jsonã®ã‚³ãƒŸãƒƒãƒˆç¦æ­¢

## ä¿¡é ¼åº¦ã‚¹ã‚³ã‚¢: 9/10

- ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã«æ˜ç¢ºãªä¾‹ãŒã‚ã‚‹
- å¤–éƒ¨APIãŒã‚ˆããƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–ã•ã‚Œã¦ã„ã‚‹
- ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³ãŒç¢ºç«‹ã•ã‚Œã¦ã„ã‚‹
- ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚²ãƒ¼ãƒˆãŒç¶²ç¾…çš„

Gmail OAuthåˆå›UXã«è‹¥å¹²ä¸å®‰ã¯ã‚ã‚‹ãŒã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒæ˜å¿«ãªã®ã§ååˆ†å¯¾å¿œå¯èƒ½ã€‚